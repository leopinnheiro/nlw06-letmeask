{"version":3,"sources":["services/firebase.ts","contexts/AuthContext.tsx","assets/images/illustration.svg","assets/images/logo.svg","assets/images/google-icon.svg","components/Button/index.tsx","hooks/useAuth.ts","pages/Home/index.tsx","pages/NewRoom/index.tsx","assets/images/copy.svg","components/RoomCode/index.tsx","pages/Room/index.tsx","App.tsx","index.tsx"],"names":["firebase","initializeApp","apiKey","process","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","auth","database","AuthContext","createContext","AuthContextProvider","children","useState","user","setUser","a","provider","GoogleAuthProvider","signInWithPopup","result","displayName","photoURL","uid","Error","id","name","avatar","useEffect","unsubscribe","onAuthStateChanged","Provider","value","signInWithGoogle","Button","props","className","useAuth","useContext","Home","history","useHistory","roomCode","setRoomCode","push","event","preventDefault","trim","ref","get","exists","alert","src","illustrationImg","alt","logoImg","onClick","googleIconImg","onSubmit","type","placeholder","onChange","target","NewRoom","newRoom","setNewRoom","roomRef","title","authorId","firebaseRoom","key","to","RoomCode","code","navigator","clipboard","writeText","copyImg","Room","params","useParams","newQuestion","setNewQuestion","questions","setQuestions","setTitle","roomId","question","content","author","isHighlighted","isAnswered","on","room","databaseRoom","val","firebaseQuestions","parsedQuestions","Object","entries","map","length","disabled","App","basename","path","exact","component","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.b8aa0122.chunk.js","sourcesContent":["import firebase from 'firebase/app';\nimport 'firebase/auth';\nimport 'firebase/database';\n\nconst firebaseConfig = {\n  apiKey: process.env.REACT_APP_API_KEY,\n  authDomain: process.env.REACT_APP_AUTH_DOMAIN,\n  databaseURL: process.env.REACT_APP_DATABASE_URL,\n  projectId: process.env.REACT_APP_PROJECT_ID,\n  storageBucket: process.env.REACT_APP_STORAGE_BUCKET,\n  messagingSenderId: process.env.REACT_APP_MESSAGING_SENDER_ID,\n  appId: process.env.REACT_APP_APP_ID\n};\n\nfirebase.initializeApp(firebaseConfig);\n\nconst auth = firebase.auth();\nconst database = firebase.database();\n\nexport { firebase, auth, database };","import { createContext, ReactNode, useState, useEffect } from \"react\";\nimport { auth, firebase } from '../services/firebase';\n\ntype User = {\n  id: string;\n  name: string;\n  avatar: string;\n}\n\ntype AuthContextType = {\n  user: User | undefined;\n  signInWithGoogle: () => Promise<void>;\n}\n\ntype AuthContextProviderProps = {\n  children: ReactNode;\n}\n\nexport const AuthContext = createContext({} as AuthContextType);\n\nexport function AuthContextProvider({ children }: AuthContextProviderProps) {\n  const [user, setUser] = useState<User>();\n\n  // Verificação para identificar se o usuario já se logou alguma vez.\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      if (user) {\n        const { displayName, photoURL, uid } = user;\n\n        if (!displayName || !photoURL) {\n          throw new Error('Missing information from Google Account');\n        }\n\n        setUser({\n          id: uid,\n          name: displayName,\n          avatar: photoURL,\n        });\n      }\n    });\n\n    return () => {\n      unsubscribe();\n    }\n  }, []);\n\n  async function signInWithGoogle() {\n    const provider = new firebase.auth.GoogleAuthProvider();\n    const result = await auth.signInWithPopup(provider);\n\n    if (result.user) {\n      const { displayName, photoURL, uid } = result.user;\n\n      if (!displayName || !photoURL) {\n        throw new Error('Missing information from Google Account');\n      }\n\n      setUser({\n        id: uid,\n        name: displayName,\n        avatar: photoURL,\n      });\n    }\n  }\n\n  return (\n    <AuthContext.Provider value={{ user, signInWithGoogle }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}","export default __webpack_public_path__ + \"static/media/illustration.ae7276f0.svg\";","export default __webpack_public_path__ + \"static/media/logo.a88331cb.svg\";","export default __webpack_public_path__ + \"static/media/google-icon.df15d8e5.svg\";","import { ButtonHTMLAttributes } from \"react\";\nimport './styles.scss';\n\ntype ButtonProps = ButtonHTMLAttributes<HTMLButtonElement>;\n\nexport function Button(props: ButtonProps) {\n  return (\n    <button className=\"button\" {...props} />\n  );\n}","import { useContext } from 'react';\nimport { AuthContext } from \"../contexts/AuthContext\";\n\nexport function useAuth() {\n  const value = useContext(AuthContext);\n\n  return value;\n}","import { FormEvent, useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { database } from \"../../services/firebase\";\n\nimport illustrationImg from '../../assets/images/illustration.svg';\nimport logoImg from '../../assets/images/logo.svg';\nimport googleIconImg from '../../assets/images/google-icon.svg';\nimport { Button } from '../../components/Button';\nimport { useAuth } from \"../../hooks/useAuth\";\n\nimport './styles.scss';\n\nexport function Home() {\n  const history = useHistory();\n  const { user, signInWithGoogle } = useAuth();\n  const [roomCode, setRoomCode] = useState('');\n\n  async function handleCreateRoom() {\n    if (!user) {\n      await signInWithGoogle();\n    }\n\n    history.push('/rooms/new');\n  }\n\n  async function handleJoinRoom(event: FormEvent) {\n    event.preventDefault();\n\n    if (roomCode.trim() === ''){\n      return;\n    }\n\n    const roomRef = await database.ref(`rooms/${roomCode}`).get();\n\n    if (!roomRef.exists()) {\n      alert('Room does not exist.');\n      return;\n    }\n\n    history.push(`/rooms/${roomCode}`);\n  }\n\n  return (\n    <div id=\"page-auth\">\n      <aside>\n        <img src={illustrationImg} alt=\"Ilustração simbolizando perguntas e respostas\" />\n        <strong>Crie salas de Q&amp;A ao-vivo</strong>\n        <p>Tire as dúvidas  da sua audiência em tempo-real</p>\n      </aside>\n      <main>\n        <div className=\"main-content\">\n          <img src={logoImg} alt=\"Letmeask\" />\n          <button\n            className=\"create-room\"\n            onClick={handleCreateRoom}\n          >\n            <img src={googleIconImg} alt=\"Logo do Google\" />\n            Crie sua sala com o Google\n          </button>\n          <div className=\"separator\">ou entre em uma sala</div>\n          <form onSubmit={handleJoinRoom}>\n            <input\n              type=\"text\"\n              placeholder=\"Digite o código da sala\"\n              onChange={event => setRoomCode(event.target.value)}\n              value={roomCode}\n            />\n            <Button type=\"submit\">\n              Entrar na sala\n            </Button>\n          </form>\n        </div>\n      </main>\n    </div>\n  );\n};","import { FormEvent, useState } from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport illustrationImg from '../../assets/images/illustration.svg';\nimport logoImg from '../../assets/images/logo.svg';\nimport { Button } from '../../components/Button';\nimport { useAuth } from \"../../hooks/useAuth\";\nimport { database } from \"../../services/firebase\";\n\nimport './styles.scss';\n\nexport function NewRoom() {\n  const { user } = useAuth();\n  const [newRoom, setNewRoom] = useState('');\n  const history = useHistory();\n\n  async function handleCreateNewRoom(event: FormEvent) {\n    event.preventDefault();\n    \n    if (newRoom.trim() === ''){\n      return;\n    }\n\n    const roomRef = database.ref('rooms');\n    const firebaseRoom = await roomRef.push({\n      title: newRoom,\n      authorId: user?.id,\n    });\n\n    history.push(`/rooms/${firebaseRoom.key}`);\n  }\n\n  return (\n    <div id=\"page-auth\">\n      <aside>\n        <img src={illustrationImg} alt=\"Ilustração simbolizando perguntas e respostas\" />\n        <strong>Crie salas de Q&amp;A ao-vivo</strong>\n        <p>Tire as dúvidas  da sua audiência em tempo-real</p>\n      </aside>\n      <main>\n        <div className=\"main-content\">\n          <img src={logoImg} alt=\"Letmeask\" />\n          <h2>Criar uma nova sala</h2>\n          <form onSubmit={handleCreateNewRoom}>\n            <input\n              type=\"text\"\n              placeholder=\"Nome da sala\"\n              onChange={event => setNewRoom(event.target.value)}\n              value={newRoom}\n            />\n            <Button type=\"submit\">\n              Criar sala\n            </Button>\n          </form>\n          <p>\n            Quer entrar em uma sala já existente? <Link to=\"/\">Clique aqui</Link>\n          </p>\n        </div>\n      </main>\n    </div>\n  );\n};","export default __webpack_public_path__ + \"static/media/copy.2f36f99e.svg\";","import copyImg from '../../assets/images/copy.svg';\nimport './styles.scss';\n\ntype RoomCodeProps = {\n  code: string;\n}\n\nexport function RoomCode({ code }: RoomCodeProps) {\n  function copyRoomCodeToClipboard() {\n    navigator.clipboard.writeText(code);\n  }\n\n  return (\n    <button\n      className=\"room-code\"\n      onClick={copyRoomCodeToClipboard}\n    >\n      <div>\n        <img src={copyImg} alt=\"Copiar código da sala\" />\n      </div>\n      <span>Sala #{code}</span>\n    </button>\n  );\n}","import { FormEvent, useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport logoImg from '../../assets/images/logo.svg';\nimport { Button } from '../../components/Button';\nimport { RoomCode } from '../../components/RoomCode';\nimport { useAuth } from '../../hooks/useAuth';\nimport { database } from '../../services/firebase';\nimport './styles.scss';\n\ntype FirebaseQuestions = Record<string, {\n  author: {\n    name: string;\n    avatar: string;\n  }\n  content: string;\n  isHighlighted: string;\n  isAnswered: string;\n}>\n\ntype Question = {\n  id: string;\n  author: {\n    name: string;\n    avatar: string;\n  }\n  content: string;\n  isHighlighted: string;\n  isAnswered: string;\n}\n\ntype RoomParams = {\n  id: string;\n}\n\nexport function Room() {\n  const { user } = useAuth();\n  const params = useParams<RoomParams>();\n  const [newQuestion, setNewQuestion] = useState('');\n  const [questions, setQuestions] = useState<Question[]>([]);\n  const [title, setTitle] = useState('');\n\n  const roomId = params.id;\n\n  // Carrega informações da sala, perguntas, titulo\n  useEffect(() => {\n    const roomRef = database.ref(`rooms/${roomId}`);\n\n    roomRef.on('value', room => {\n      const databaseRoom = room.val();\n      const firebaseQuestions: FirebaseQuestions = databaseRoom.questions ?? {};\n\n      const parsedQuestions = Object.entries(firebaseQuestions).map(([key, value]) => {\n        return {\n          id: key,\n          content: value.content,\n          author: value.author,\n          isHighlighted: value.isHighlighted,\n          isAnswered: value.isAnswered,\n        }\n      });\n\n      setTitle(databaseRoom.title);\n      setQuestions(parsedQuestions);\n    })\n  }, [roomId]);\n\n  // Cria uma nova pergunta\n  async function handleSendQuestion(event: FormEvent) {\n    event.preventDefault();\n\n    if (newQuestion.trim() === '') {\n      return;\n    }\n\n    if (!user) {\n      throw new Error('You must be logged in');\n    }\n\n    const question = {\n      content: newQuestion,\n      author: {\n        name: user.name,\n        avatar: user.avatar,\n      },\n      isHighlighted: false,\n      isAnswered: false\n    }\n\n    await database.ref(`rooms/${roomId}/questions`).push(question);\n    setNewQuestion('');\n  }\n\n  return (\n    <div id=\"page-room\">\n      <header>\n        <div className=\"content\">\n          <img src={logoImg} alt=\"Letmeask\" />\n          <RoomCode code={roomId}/>\n        </div>\n      </header>\n\n      <main>\n        <div className=\"room-title\">\n          <h1>Sala {title}</h1>\n          {questions.length > 0 &&\n          <span>{questions.length} pergunta(s)</span> }\n        </div>\n\n        <form\n          onSubmit={handleSendQuestion}\n        >\n          <textarea\n            placeholder=\"O que você quer perguntar?\"\n            onChange={event => setNewQuestion(event.target.value)}\n            value={newQuestion}\n          />\n\n          <div className=\"form-footer\">\n            { user ? (\n              <div className=\"user-info\">\n                <img src={user.avatar} alt={user.name} />\n                <span>{user.name}</span>\n              </div>\n            ) : (\n              <span>Para enviar uma pergunta, <button>faça seu login</button>.</span>\n            ) }\n            <Button\n              type=\"submit\"\n              disabled={!user}\n            >\n              Enviar pergunta\n            </Button>\n          </div>\n        </form>\n      </main>\n    </div>\n  );\n}","import { BrowserRouter, Route, Switch } from \"react-router-dom\";\nimport { AuthContextProvider } from './contexts/AuthContext';\n\nimport { Home } from \"./pages/Home\";\nimport { NewRoom } from \"./pages/NewRoom\";\nimport { Room } from \"./pages/Room\";\n\nexport function App() {\n  return (\n    <BrowserRouter basename=\"/nlw06-letmeask\">\n      <AuthContextProvider>\n        <Switch>\n          <Route path=\"/\" exact component={Home} />\n          <Route path=\"/rooms/new\" component={NewRoom} />\n          <Route path=\"/rooms/:id\" component={Room} />\n        </Switch>\n      </AuthContextProvider>\n    </BrowserRouter>\n  );\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { App } from './App';\n\nimport './services/firebase';\nimport './styles/global.scss';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}